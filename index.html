<!DOCTYPE html>
<html lang="pt-PT">
<head>
  <meta charset="UTF-8">
  
  <title>Baba de Cascais</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
    <header class="team-header">
    <img src="https://babadecascais.blob.core.windows.net/patrocinadores/BABA TRANSP (1).jpg" 
         alt="Baba de Cascais" class="team-logo">
    <h1>Agenda de Jogos</h1>
  </header>

  <select id="timeSelect">
    <option value="">Selecione um time</option>
  </select>

  <div class="calendar-nav">
    <button id="prevMonth">&#9664;</button>
    <span id="monthLabel"></span>
    <button id="nextMonth">&#9654;</button>
  </div>

  <div class="calendar" id="calendar"></div>

  <!-- Modal -->
  <div id="gameModal" class="modal">
    <div class="modal-content">
      <span id="closeModal" class="close">&times;</span>
      <div id="modalBody"></div>
    </div>
  </div>

  <script>
    let dadosGlobal = null;
    let anoAtual, mesAtual;

    async function carregar() {
      const resp = await fetch("https://babadecascais.blob.core.windows.net/baba/jogos.json");
      dadosGlobal = await resp.json();

      const select = document.getElementById("timeSelect");
      dadosGlobal.times.forEach(time => {
        const opt = document.createElement("option");
        opt.value = time.nome;
        opt.textContent = time.nome;
        select.appendChild(opt);
      });

      const hoje = new Date();
      anoAtual = hoje.getFullYear();
      mesAtual = hoje.getMonth();

      select.addEventListener("change", () => {
        montarCalendario(select.value);
      });

      document.getElementById("prevMonth").addEventListener("click", () => {
        mesAtual--;
        if (mesAtual < 0) {
          mesAtual = 11;
          anoAtual--;
        }
        montarCalendario(select.value);
      });

      document.getElementById("nextMonth").addEventListener("click", () => {
        mesAtual++;
        if (mesAtual > 11) {
          mesAtual = 0;
          anoAtual++;
        }
        montarCalendario(select.value);
      });
    }

    function montarCalendario(nomeTime) {
      const calendar = document.getElementById("calendar");
      calendar.innerHTML = "";

      const monthLabel = document.getElementById("monthLabel");
      const nomeMes = new Date(anoAtual, mesAtual).toLocaleString("pt-PT", { month: "long", year: "numeric" });
      monthLabel.textContent = nomeMes.charAt(0).toUpperCase() + nomeMes.slice(1);

      const ultimoDia = new Date(anoAtual, mesAtual + 1, 0);
      const diasNoMes = ultimoDia.getDate();

      const time = dadosGlobal.times.find(t => t.nome === nomeTime);
      if (!time) return;

      for (let dia = 1; dia <= diasNoMes; dia++) {
        const cell = document.createElement("div");
        cell.className = "day";

        const num = document.createElement("div");
        num.className = "day-number";

        const diaSemana = new Date(anoAtual, mesAtual, dia)
          .toLocaleString("pt-PT", { weekday: "long" });
        const diaSemanaFormatado = diaSemana.charAt(0).toUpperCase() + diaSemana.slice(1);

        num.textContent = `${dia} - ${diaSemanaFormatado}`;
        cell.appendChild(num);

        const dataStr = `${anoAtual}-${String(mesAtual+1).padStart(2,"0")}-${String(dia).padStart(2,"0")}`;
        const jogosDia = time.jogos.filter(j => j.data === dataStr);

        jogosDia.forEach((jogo) => {
          const card = document.createElement("div");
          card.className = "jogo";

          let adversarioHtml = "";
          if (nomeTime !== "Baba Semanal" && jogo.adversario) {
            adversarioHtml = ` | <span class="versus">vs ${jogo.adversario}</span>`;
          }

          card.innerHTML = `
            <span class="linha-jogo">
              <strong>${jogo.hora}</strong> 
              <span class="local-icon">
                <svg class="pin-icon" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="#e74c3c">
                  <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5S10.62 6.5 12 6.5s2.5 1.12 2.5 2.5S13.38 11.5 12 11.5z"/>
                </svg>
              </span> ${jogo.local}${adversarioHtml}
            </span>
          `;

          card.addEventListener("click", () => {
            const modal = document.getElementById("gameModal");
            const modalBody = document.getElementById("modalBody");

            const golSvg = `<svg class="stat-icon" xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="#2c3e50" viewBox="0 0 24 24"><path d="M12 2a10 10 0 100 20 10 10 0 000-20z"/></svg>`;
            const assistSvg = `<svg class="stat-icon" xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="#27ae60" viewBox="0 0 24 24"><path d="M12 2L15 8l6 1-4.5 4 1 6-5.5-3-5.5 3 1-6L3 9l6-1z"/></svg>`;
            const amareloSvg = `<svg class="stat-icon" xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="#f1c40f" viewBox="0 0 24 24"><rect x="6" y="4" width="12" height="16" rx="2"/></svg>`;
            const vermelhoSvg = `<svg class="stat-icon" xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="#e74c3c" viewBox="0 0 24 24"><rect x="6" y="4" width="12" height="16" rx="2"/></svg>`;

            const golsHtml = jogo.gols?.length
              ? `<div class="stat">${golSvg}<strong> Gols:</strong> ${jogo.gols.join(", ")}</div>`
              : "";

            const assistHtml = jogo.assistencias?.length
              ? `<div class="stat">${assistSvg}<strong> Assist√™ncias:</strong> ${jogo.assistencias.join(", ")}</div>`
              : "";

            const cartoesHtml = jogo.cartoes?.length
              ? `<div class="stat"><strong> Cart√µes:</strong> ${jogo.cartoes.map(c => {
                  const icon = c.tipo === "vermelho" ? vermelhoSvg : amareloSvg;
                  return `${icon} ${c.jogador}`;
                }).join(", ")}</div>`
              : "";

            // advers√°rio s√≥ se n√£o for Baba Semanal
            let adversarioModal = "";
            if (nomeTime !== "Baba Semanal" && jogo.adversario) {
              adversarioModal = ` | vs ${jogo.adversario}`;
            }

            // times escolhidos s√≥ se for Baba Semanal
            let timesEscolhidosHtml = "";
            if (nomeTime === "Baba Semanal" && jogo.timesEscolhidos?.length) {
              timesEscolhidosHtml = `
              <h4>Times Escolhidos:</h4>
              <div class="times-container">
                ${jogo.timesEscolhidos.map((t, idx) => `
                  <div class="time-card time-${idx+1}">
                    <strong>${t.nomeTime}</strong>
                    <ul>${t.jogadores.map(j => `<li>${j}</li>`).join("")}</ul>
                  </div>
                `).join("")}
              </div>
            `;


            }

                       modalBody.innerHTML = `
              <h2>${jogo.hora} üìç ${jogo.local}${adversarioModal}</h2>
              <h4>Escalados:</h4>
              <ul>${jogo.escalados.map(p => `<li>${p}</li>`).join("")}</ul>
              ${timesEscolhidosHtml}
              <div class="estatisticas">
                ${golsHtml}
                ${assistHtml}
                ${cartoesHtml}
              </div>
            `;

            modal.style.display = "block";
          });

          cell.appendChild(card);
        });

        calendar.appendChild(cell);
      }
    }

    // Fechar modal
    document.addEventListener("DOMContentLoaded", () => {
      const closeModal = document.getElementById("closeModal");
      const modal = document.getElementById("gameModal");
      closeModal.addEventListener("click", () => modal.style.display = "none");
      window.addEventListener("click", (e) => {
        if (e.target === modal) modal.style.display = "none";
      });
    });

    carregar();
  </script>

  <footer class="sponsors">
  <h4>Patrocinadores</h4>
  <div class="sponsor-logos">
    <img src="https://babadecascais.blob.core.windows.net/patrocinadores/LogoAignosi.png" alt="Aignosi">
    <img src="https://babadecascais.blob.core.windows.net/patrocinadores/LogoEuroCar.png" alt="Eurocar">
    <img src="https://babadecascais.blob.core.windows.net/patrocinadores/LogoOmega.jpg" alt="Grupo Omega">
    <img src="https://babadecascais.blob.core.windows.net/patrocinadores/LogoVitoretti.jpeg" alt="Vitoretti Auto Centro">
  </div>
</footer>

  
</body>
</html>

